<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
    />
    <title>Flybys Visualization</title>

    <!-- shaders -->
    <script type="x-shader/x-vertex" id="vertexshader">
      varying vec2 vUv;
      void main() {
      	vUv = uv;
      	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
      }
    </script>
    <script type="x-shader/x-fragment" id="fragmentshader">
      uniform sampler2D baseTexture;
      uniform sampler2D bloomTexture;
      varying vec2 vUv;
      void main() {
      	gl_FragColor = ( texture2D( baseTexture, vUv ) + vec4( 1.0 ) * texture2D( bloomTexture, vUv ) );
      }
    </script>

    <link rel="stylesheet" href="css/jquery-ui.min.css" />
    <link rel="stylesheet" href="css/jquery-ui.structure.min.css" />
    <link rel="stylesheet" href="css/jquery-ui.theme.min.css" />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link rel="stylesheet" href="css/orrery.css" />

    <link rel="manifest" href="data/manifest.json" />
    <meta name="msapplication-TileColor" content="#ffffff" />
    <meta name="msapplication-TileImage" content="data/ms-icon-144x144.png" />
    <meta name="theme-color" content="#ffffff" />

    <style>
      #flyby-visualization {
        height: 100svh;
        width: 100%;
        overflow: scroll;

        display: flex;
        flex-direction: column;
      }
      .flyby-container {
        width: 100%;
        display: flex;
      }
      .flyby-image,
      .flyby-description {
        flex: 0.5;
        color: white;
        padding: 40px;
      }
      .flyby-description {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 20px 20px;
        flex-direction: column;
        gap: 20px;
      }

      .flyby-description button {
        border: 1px solid white;
        outline: none;
        border-radius: 30px;
        padding: 10px 50px;
        color: white;
        width: 300px;
        height: 50px;
      }

      .flyby-image img {
        height: 400px;
        object-fit: contain;
      }

      .flyby-seemore {
        transition: linear 0.5s;
        cursor: pointer;
      }

      .flyby-seemore:hover {
        transform: scale(1.1);
      }

      /* modal part */
      #modal-background {
        display: none;
        background-color: rgba(0, 0, 0, 0.2);
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        z-index: 1;
      }

      #modal {
        background-color: rgb(59, 59, 59);
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 80%;
        height: 90%;
        padding: 10px 20px;
        border-radius: 5px;
        display: flex;
        flex-direction: column;
        align-items: center;
        box-shadow: 0 14px 28px rgba(0, 0, 0, 0.25),
          0 10px 10px rgba(0, 0, 0, 0.22);
        font-size: 1.5rem;
        animation-name: animatemodal;
        animation-duration: 0.4s;
        z-index: 999;

        overflow: scroll;
      }

      .yes,
      .no {
        border: none;
        padding: 7px 14px;
        font-size: 1rem;
        border-radius: 5px;
      }

      #close-btn {
        align-self: flex-start;
        font-size: 4rem;
        color: white;
      }

      #close-btn:hover {
        cursor: pointer;
        color: #ff0000;
      }

      /* modal part end */

      /* animation part */
      @keyframes animatemodal {
        from {
          top: -300px;
          opacity: 0;
        }
        to {
          top: 50%;
          opacity: 1;
        }
      }
    </style>
  </head>
  <body>
    <div id="nav-tabs" style="z-index: 888">
      <div
        class="nav-link"
        id="bennu-btn"
        onclick="window.location.assign('./index.html')"
      >
        Home
      </div>
      <div class="nav-link" onclick="window.location.assign('./flyby.html')">
        Flybys
      </div>
    </div>

    <div id="splashScreen">
      <div id="splash-loading-wrapper">
        <div id="loading-ring"></div>
        <div id="logo-background"></div>
        <img id="logo" src="data/logo.png" style="object-fit: contain" />
      </div>
      <div id="splash-content-container">
        <script>
          if (/Mobi|Android/i.test(navigator.userAgent)) {
            document.getElementById("splash-content-container").hidden = true;
          }
        </script>
        <p>Neomunchers get ready with your munchies to explore the universe</p>
        <p>
          Data courtesy of <a href="http://nasa.gov" target="_blank">NASA</a>,
          <a href="http://jpl.nasa.gov" target="_blank">JPL</a>,
          <a href="http://en.wikipedia.org" target="_blank">Wikipedia</a>, and
          <a href="https://www.solarsystemscope.com" target="_blank"
            >Solar System Scope</a
          >.
        </p>
        <button id="clearSplash">Close</button>
      </div>
    </div>

    <div id="flyby-visualization"></div>

    <div id="modal-background">
      <div id="modal">
        <span id="close-btn">&times;</span>
      </div>
    </div>
  </body>
  <script>
    const splashScreen = document.getElementById("splashScreen");
    const dataSets = [
      {
        Abb: "Didymous",
        Name: "65803",
        Epoch_MJD: 60600.0,
        SemMajAxis_AU: 1.64259976140734,
        Ecc_: 0.383251161082194,
        Incl_deg: 3.41417459801425,
        LongAscNode_deg: 72.9859390758235,
        ArgP_deg: 319.602700791966,
        MeanAnom_deg: 339.929961479886,
        AbsMag_: 18.12,
        SlopeParamG_: 0.15,
        Aphel_AU: 2.27212802716004,
        Perihel_AU: 1.01307149565464,
        NEOClass: "Apollo",
        story: `Didymos is a near-Earth asteroid (NEO) discovered in 1996. It is part of a binary system, with the
    main body measuring about 780 meters in diameter and a smaller "moonlet," named Dimorphos,
    orbiting it. Didymos is classified as a Potentially Hazardous Asteroid (PHA) due to its proximity
    to Earth's orbit.
    In 2022, NASA's DART (Double Asteroid Redirection Test) mission targeted Didymos' moonlet
    Dimorphos to test planetary defense techniques. The mission successfully altered Dimorphos' orbit,
    demonstrating that asteroids can be deflected, an important step in protecting Earth from future
    asteroid threats. Didymos’ unique characteristics make it a valuable subject for understanding NEOs
    and planetary defense strategies.`,
        image: "/flybys_gif/didymos.gif",
        moreImages: [
          "/flybys_gif/didymos.gif",
          "/flybys_gif/dimorphos.gif",
          "/flybys_gif/dartdimorphosimpct.png",
          "/flybys_gif/dartdimorphosimpacebeforeseconds.png",
        ],
        detailStory: `Dimorphos was selected for study because it provides a unique opportunity to analyze the effects of
an impact on an asteroid. At the time of the impact, Dimorphos was passing within 11 million
kilometers of Earth, allowing for precise tracking and predictions of its location. This close
approach was the best opportunity for impact, occurring on October 4, 2022, and it wouldn't come
this close again until 2062. To enhance observation, the impact was executed a week early,
coinciding with the asteroid’s brightest visibility.
The Double Asteroid Redirection Test aimed to alter Dimorphos’s trajectory just enough to avoid a
potential future collision with Earth. A change of merely one percent could be sufficient to avert
disaster. The challenge was measuring such a small shift in trajectory from a distance of 11 million
kilometers, where even spacecraft footage offered limited data. Instead of waiting years to measure
the asteroid's orbit, scientists looked at binary systems, where a smaller asteroid orbits a larger one.
This setup allows for the assessment of changes in velocity due to an impact without needing to
track multiple orbits around the Sun.
For the experiment to be effective, the orbiting asteroid needed to have an eclipsing path visible
from Earth, meaning it would pass in front of and behind the larger asteroid. This way, the two
asteroids would appear as a single point of light from our perspective, facilitating the measurement
of any changes resulting from the impact.
(Source: John Hopkins Laboratory of Applied Physics, NASA, Real Engineering Youtube)`,
        about: "1. Dart colliding with Dimorphos third person perspective. 2. Point of impact moments before DART collided with Dimorphos first person perspective",
      },
      {
        Abb: "Stein",
        Name: "2867",
        Epoch_MJD: 60600.5,
        SemMajAxis_AU: 2.365208993973021,
        Ecc_: 0.1455164445768185,
        Incl_deg: 9.929375137470117,
        LongAscNode_deg: 55.33347401848026,
        ArgP_deg: 251.3574059623025,
        MeanAnom_deg: 112.7677797273789,
        AbsMag_: 13.17,
        SlopeParamG_: 0.15,
        Aphel_AU: 2.02103219049,
        Perihel_AU: 2.02103219049,
        NEOClass: "Other",
        story: `Officially known as 2867 Šteins, is a small, diamond-shaped asteroid located in the asteroid belt,
    discovered in 1969. It’s not classified as a Near-Earth Object (NEO), as it resides between Mars
    and Jupiter, far from Earth's orbit. Steins is primarily composed of silicate materials, making it an
    E-type asteroid.
    In 2008, the European Space Agency's Rosetta spacecraft flew by Steins, capturing detailed images
    and data. This flyby revealed Steins' unique shape, cratered surface, and composition, contributing
    valuable information to the study of small bodies in the asteroid belt.`,
        image: "/flybys_gif/Stein.gif",
        moreImages: [
          "/flybys_gif/Stein.gif",
          "/flybys_gif/steinrealrosettaview.png",
        ],
        detailStory: `Story of 2867 Stein
In 2007, the Rosetta spacecraft flew by Earth for a second time, passing at a distance of 5,700 km.
During this flyby, ground-based telescopes mistook it for a near-Earth asteroid and added it to the
Catalina Sky Survey as a potential 20-meter Earth impactor. A few days later, the error was
corrected.
After gaining speed from the flyby, Rosetta’s path took it past 2867 Šteins, a small 5 km asteroid in
the asteroid belt beyond Mars, where it captured these images.
(Source: ESA, Catalina Sky Survey)`,
        about: "Stein images",
      },
      {
        Abb: "67P",
        Name: "10000012",
        Epoch_MJD: 52520.5,
        SemMajAxis_AU: 3.462249489765068,
        Ecc_: 0.6409081306555051,
        Incl_deg: 7.040294906760007,
        LongAscNode_deg: 50.13557380441372,
        ArgP_deg: 12.79824973415729,
        MeanAnom_deg: 8.859927418758764,
        AbsMag_: 12.9,
        SlopeParamG_: 0.15,
        Aphel_AU: 5.681233338113374,
        Perihel_AU: 1.243265641416762,
        NEOClass: "Other",
        story: `Though not a Near-Earth Object (NEO), 67P gained attention in 2014 when the European Space
    Agency's Rosetta mission successfully landed the Philae probe on its surface, marking the first-
    ever landing on a comet. Rosetta studied the comet's composition, revealing important clues about
    the solar system’s formation and the role comets may have played in delivering water and organics
    to Earth.`,
        image: "/flybys_gif/Comet67P.gif",
        moreImages: [
          "/flybys_gif/Comet67P.gif",
          "/flybys_gif/67pphilaelander.png",
        ],
        about: "Crashed Philae Probe pointing towards its harpoon (67p)",
        detailStory: `Philae touched down on the comet and sent a signal back to mission control, indicating a successful
landing. However, things quickly went wrong. The harpoons meant to anchor it didn’t fire, and the
probe bounced off the surface.
Commands were sent to begin scientific experiments, but at the time, Philae was actually floating in
space, still bouncing. It took a while to realize what had happened. Fortunately, the bounce was
slow, at just 38 cm per second, so it only rose about 1 kilometer before coming back down. Over
two hours, Philae bounced three times before finally coming to rest.
Unfortunately, it ended up far from its intended landing site, in a shadowy area with little sunlight.
Its solar panels couldn’t generate enough power, so the mission was cut short from an expected five
months to less than 60 hours.
By November 14th, Philae’s battery died, and communication was lost. Amazingly, in June 2015, as
the comet got closer to the Sun, Philae briefly powered on and sent a signal back to Rosetta, even
performing one last experiment. But as the comet became more active, Rosetta had to move farther
away to stay safe.
On July 9th, Philae transmitted its final signal, and then went silent for good. In September, mission
controllers finally located Philae’s resting place, with one of its legs visible on the comet’s surface.(Source: ESA)`,
      },
      {
        Abb: "Bennu",
        Name: "101955",
        Epoch_MJD: 59000.0,
        SemMajAxis_AU: 1.12590791866781,
        Ecc_: 0.203690880526369,
        Incl_deg: 6.03413493606636,
        LongAscNode_deg: 2.0073160459639,
        ArgP_deg: 66.3378414065281,
        MeanAnom_deg: 57.6007687949117,
        AbsMag_: 20.64,
        SlopeParamG_: 0.15,
        Aphel_AU: 1.35524509401287,
        Perihel_AU: 0.896570743322751,
        NEOClass: "Apollo",
        story: `Bennu, a small, ancient asteroid, has traveled through space for over 4.5 billion years. Rich in
    carbon and organic material, it's a pristine time capsule from the early solar system, possibly
    containing clues to the origin of life. Discovered in 1999, Bennu is classified as a Near-Earth
    Object (NEO), meaning it orbits close to Earth. While it poses a slight risk of collision in the late
    22nd century, its proximity makes it a key target for study.
    In 2016, NASA's OSIRIS-REx mission was launched to explore Bennu. The spacecraft collected a
    sample from its surface in 2020, returning it to Earth in 2023. Bennu’s secrets could unlock answers
    about the formation of our solar system and life itself.`,
        image: "/flybys_gif/benu.gif",
        moreImages: ["/flybys_gif/benu.gif", "/flybys_gif/osiris_landing.png"],
        detailStory: `On October 20th, 2020, OSIRIS-REx made its final descent to the sample site, Nightingale. With its
TAGSAM arm extended, it approached the surface at just 10 centimeters per second, moving as
slow as an insect. One second after touching down, it released pressurized nitrogen, blasting
particles into the TAGSAM head to collect a sample. Six seconds in, while still sinking into Bennu,
the spacecraft fired its thrusters to back away. The engine burn lasted 24 seconds, slowing its
descent. Dust and debris from the thrusters and gas release hit the science instruments, clogging
them. Nine seconds after contact, OSIRIS-REx had sunk about half a meter into Bennu before
starting to rise. Sixteen seconds in, the TAGSAM head emerged, and by 30 seconds, the thrusters
shut off as the spacecraft drifted away with its sample.
Almost six months later, on April 7th, 2021, the spacecraft made one final flyover to observe the
site. A new crater had formed at the impact point, about 8 meters wide and 68 centimeters deep. The
thruster marks crossed in an X pattern, increasing the crater's size by 40%. A ridge of material
ejected during the sample collection surrounded the crater like a ring.
With a burst of gas and an engine burn, OSIRIS-REx displaced 12 cubic meters of loose rock—
around six tons, packed as lightly as popcorn.
After its final maneuver in May 2021, OSIRIS-REx began its two-year journey back to Earth,
carrying 250 grams of asteroid Bennu for future discoveries. (Source: Surprise – Again! Asteroid Bennu Reveals its Surface is Like a Plastic Ball Pit, NASA
Goddard)`,
        about: "Bennu Landing site study simulation",
      },
    ];

    const flybySection = document.getElementById("flyby-visualization");
    dataSets.forEach((dataPoints, index) => {
      flybySection.innerHTML += `<div class="flyby-container">
        <div class="flyby-image">
          <img src="${dataPoints.image}" />
        </div>
        <div class="flyby-description">
            <div>${dataPoints.story}</div>
             <button class='flyby-seemore' onclick='showModal(${index})'>See more</button>
        </div>
       
      </div>`;
    });

    setTimeout(() => {
      splashScreen.style.display = "none";
    }, 3000);

    // select the open-btn button
    let openBtn = document.getElementById("open-btn");
    // select the modal-background
    let modalBackground = document.getElementById("modal-background");
    // select the close-btn
    let closeBtn = document.getElementById("close-btn");

    // shows the modal when the user clicks open-btn
    openBtn.addEventListener("click", function () {
      modalBackground.style.display = "block";
    });

    // hides the modal when the user clicks close-btn
    closeBtn.addEventListener("click", function () {
      console.log("gggg");
      modalBackground.style.display = "none";
    });

    // hides the modal when the user clicks outside the modal
    window.addEventListener("click", function (event) {
      // check if the event happened on the modal-background
      if (event.target === modalBackground) {
        // hides the modal
        modalBackground.style.display = "none";
      }
    });

    function closeModal() {
      modalBackground.style.display = "none";
    }

    function showModal(index) {
      modalBackground.style.display = "block";
      const dataPoint = dataSets[index];
      const orbitalData = { ...dataPoint };
      delete orbitalData.image;
      delete orbitalData.story;
      delete orbitalData.moreImages;
      delete orbitalData.detailStory;
      delete orbitalData.about;
      const modalContainer = document.getElementById("modal");

      let orbitalDataHTMLString = "";
      let imagesHTMLString = "";

      Object.keys(orbitalData).map((item) => {
        orbitalDataHTMLString += `<span>${item}: ${orbitalData[item]}</span>`;
      });
      dataPoint.moreImages.map((item) => {
        imagesHTMLString += `<img src="${item}" style="height: 400px; object-fit: contain;" />`;
      });

      modalContainer.innerHTML = `        <span id="close-btn" onclick="closeModal()">&times;</span>
<div style="display: flex;flex-direction: column;gap: 20px; color: white;">

          <div style="color: white; display:flex; gap: 10px; flex-wrap: wrap;">
            ${imagesHTMLString}
          </div>
          <div>Fig: ${dataPoint.about}</div>

          <div style="display: flex; flex-direction: column;gap: 10px;">
            <h3>About</h3>
            <div>${dataPoint.detailStory}</div>
            <h3>Orbital Data</h3>
            <div style="display:flex;flex-direction: column;gap:5px;">
              ${orbitalDataHTMLString}
            </div>
          </div>


        </div>`;
    }
  </script>
</html>
